<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<META name="GENERATOR" content="IBM WebSphere Homepage Builder V6.0.1 for Windows">
<META http-equiv="Content-Style-Type" content="text/css">
<TITLE>エディタのDDE制御</TITLE>
</HEAD>
<BODY>
<H1>エディタのDDE制御</H1>
<HR>
<P>＊この話題は、プログラマー用です。</P>
<HR>
<P>■エディタで、ＤＤＥを使う</P>
<BLOCKQUOTE>Windowsが、アプリケーションの通信に利用しているＤＤＥを、利用することが出来る言語を用いると、サクラのエディタである、sakura.exeを、ＤＤＥの受信（サーバー）として利用できます。</BLOCKQUOTE>
<P>■メリット</P>
<BLOCKQUOTE>サクラのエディタをプログラムから操作することにより、文章の挿入・置換など、定型処理を簡単に出来ます。</BLOCKQUOTE>
<P>■使い方</P>
<BLOCKQUOTE>ここでは、拙作の、日本語プログラム言語「ひまわり」を使った、エディタ操作の例を紹介します。<BR>
<BR>
サクラエディタに、ひまわりで、コマンドを送るには、「ＤＤＥ送信」という命令を使います。<BR>
<BR>
例えば、現在編集しているプログラムを保存するには、<BR>
<TABLE border="1">
  <TBODY>
    <TR>
      <TD bgcolor="#ffffcc">『<B>sakura</B>』の,『<B>command</B>』に,『save』を,<B>DDE送信</B>。</TD>
    </TR>
  </TBODY>
</TABLE>
と、書きます。<BR>
<BR>
（３つ目の『』の中を、以下のコマンドに書き換えます。）<BR>
<TABLE border="1">
  <TBODY>
    <TR>
      <TD bgcolor="#99ffcc">コマンド</TD>
      <TD bgcolor="#99ffcc">説明</TD>
    </TR>
    <TR>
      <TD>new</TD>
      <TD>エディタを初期化します</TD>
    </TR>
    <TR>
      <TD>open ファイル名</TD>
      <TD>ファイル名に指定したファイルを開きます。</TD>
    </TR>
    <TR>
      <TD>save</TD>
      <TD>現在編集中のファイルを保存します。</TD>
    </TR>
    <TR>
      <TD>saveas ファイル名</TD>
      <TD>ファイル名に指定したファイルへ編集中のプログラムを保存します。</TD>
    </TR>
    <TR>
      <TD>insert 文字列</TD>
      <TD>文字列を、現在のカーソル位置に挿入します。</TD>
    </TR>
    <TR>
      <TD>row 行番号</TD>
      <TD>カーソルを行番号に移動します。</TD>
    </TR>
    <TR>
      <TD>col 列番号</TD>
      <TD>カーソルを列番号に移動します。</TD>
    </TR>
    <TR>
      <TD>copy</TD>
      <TD>現在選択中のテキストをクリップボードへコピーします。</TD>
    </TR>
    <TR>
      <TD>paste</TD>
      <TD>クリップボードの内容を、エディタへ貼り付けます。</TD>
    </TR>
    <TR>
      <TD>seltext_save ファイル名</TD>
      <TD>選択中のテキストを、指定ファイルへ保存します。</TD>
    </TR>
    <TR>
      <TD>seltext_open ファイル名</TD>
      <TD>選択中のテキストを、指定ファイルの内容に書き換えます。</TD>
    </TR>
    <TR>
      <TD>play</TD>
      <TD>エディタの内容を演奏します。</TD>
    </TR>
    <TR>
      <TD>stop</TD>
      <TD>演奏を中止します。</TD>
    </TR>
  </TBODY>
</TABLE>
</BLOCKQUOTE>
<P>■サンプル「選択しているテキストを置換する」</P>
<BLOCKQUOTE>以下のサンプルは、エディタの選択している部分を、大文字に変換するプログラムです。<BR>
<TABLE border="1">
  <TBODY>
    <TR>
      <TD bgcolor="#ffffcc"><CODE><B><FONT color="#ff6633">'エディタの選択中テキストを大文字に変換する</FONT></B><BR>
      <BR>
      &quot;sakura&quot;の、&quot;command&quot;へ、&quot;<B>copy</B>&quot;を、DDE送信。'***1<BR>
      <BR>
      「テキストを大文字にします」と、二択。<BR>
      もし、それが、いいえならば、おわり。<BR>
      <BR>
      クリップボードを、開く。<BR>
      それを、大文字変換。'***2<BR>
      クリップボードへ、保存。<BR>
      &quot;himapad&quot;の、&quot;command&quot;へ、&quot;<B>paste</B>&quot;を、DDE送信。'***3<BR>
      おわり</CODE></TD>
    </TR>
  </TBODY>
</TABLE>
***1: サクラのエディタへ、選択領域をクリップボードにコピーしなさいと、命令。<BR>
***2: クリップボードの内容を、それに得て、大文字に変換<BR>
***3: サクラのエディタへ、クリップボードの内容を選択領域へ貼り付けなさいと、命令。</BLOCKQUOTE>
<HR>
<P><A href="index.htm">戻る</A></P>
</BODY>
</HTML>
